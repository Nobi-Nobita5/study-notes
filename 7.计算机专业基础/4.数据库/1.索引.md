深入理解数据库索引类型**概念**（- 唯一索引/非唯一索引 - 主键索引（主索引） - 聚集索引/非聚集索引 - 组合索引）唯一索引/非唯一索引主键索引（主索引）聚集索引/非聚集索引5.组合索引（联合索引）

这些索引类别是概念上的说法：比如在MySQL的InnoDB存储引擎中，聚集索引默认是主键索引。

https://cloud.tencent.com/developer/article/1193302



1. 索引是不是越多越好，为什么？

   > 不是的，索引并不是越多越好。虽然索引可以提高查询速度，但过多的索引也会带来一些问题：
   >
   > 1. **增加写操作的成本**：当数据发生变化（如插入、删除、更新）时，索引也需要相应地进行修改。如果有很多索引，那么每次数据变化都需要更新所有的索引，这将大大增加写操作的成本。
   > 2. **占用更多的存储空间**：每个索引都会占用一定的存储空间。如果有很多索引，那么需要的存储空间也会相应地增加。
   > 3. **影响查询优化器的效率**：在处理查询时，MySQL查询优化器需要决定使用哪个索引。如果有很多索引，查询优化器需要花费更多的时间来选择最优的索引，这可能会影响查询的性能。

2. 聚集索引和非聚集索引概念的区别，它们的数据结构都是B+树吗？

   > **聚集索引**：
   >
   > - 聚集索引的特点是，它按照每张表的主键进行排序，并且直接包含了与每个键关联的行数据。换句话说，索引的逻辑顺序决定了表中行的物理存储顺序。因此，一张表只能有一个聚集索引。
   > - 聚集索引通常使用B+树数据结构，其中每个叶节点都包含了实际的行数据。这使得按照主键进行的查询非常高效，因为可以直接通过索引找到数据，而无需额外的读取操作。
   >
   > **非聚集索引**：
   >
   > - 非聚集索引，也被称为二级索引或辅助索引，是不改变表中行的物理顺序的索引。非聚集索引包含一个指向每个表行的指针，这通常是主键或者行的物理地址。
   > - 非聚集索引同样使用B+树数据结构，但与聚集索引不同的是，它的叶节点并不包含实际的行数据，而是包含指向行数据的指针。当通过非聚集索引进行查询时，数据库系统需要先通过索引找到指针，然后通过指针读取实际的数据，这被称为“回表”操作。
   >
   > 总的来说，聚集索引和非聚集索引在许多方面都有各自的优势和劣势。**聚集索引对于主键查询非常高效，但对于插入和删除操作可能较慢，因为可能需要重新组织存储的数据。非聚集索引可以提高非主键查询的性能，但可能需要额外的回表操作。**因此，选择使用哪种类型的索引需要根据具体的查询需求和数据分布来决定。
   >
   > ---
   >
   > **在InnoDB存储引擎中，主键索引（即默认的聚集索引）和非聚集索引都使用了B+树数据结构。**聚集索引的叶节点直接包含了完整的数据行，而非聚集索引的叶节点则包含了指向对应数据行的指针（如果非聚集索引不是基于主键创建的，则叶节点会包含主键的值作为指针）。
   >
   > ---
   >
   > ##### 如果我们要创建一个索引，它是非聚集索引且是唯一索引，是否可以使用如下语句？
   >
   > ~~~sql
   > CREATE UNIQUE INDEX idx_email
   > ON my_table(email);
   > ~~~
   >
   > 解释：
   >
   > 在SQL语句中，`CREATE INDEX`命令是用来创建索引的，而`UNIQUE`关键字是用来确保索引的值是唯一的。但这个命令并不能指定创建的索引是聚集的还是非聚集的。索引是否是聚集索引或非聚集索引，取决于数据库的具体实现和表的定义。
   >
   > 例如，**在MySQL的InnoDB存储引擎中，聚集索引默认是主键索引。**如果你没有明确指定表的主键，那么InnoDB会选择一个唯一非空的列作为聚集索引。如果没有这样的列，InnoDB会生成一个内部的ROW_ID作为聚集索引。所以，在这个例子中，如果`email`列不是表的主键，且表中没有其他的聚集索引，那么使用`CREATE UNIQUE INDEX idx_email ON my_table(email);`这个命令将会创建一个唯一的非聚集索引。但如果`email`列是表的主键，那么这个命令将会创建一个唯一的聚集索引。
   >
   > 所以，对于`CREATE UNIQUE INDEX idx_email ON my_table(email);`这个命令，我们不能确定创建的是聚集索引还是非聚集索引，这取决于数据库的具体实现和表的定义。

