#### 一、简介

使用HBASE进行大数据处理，返回结果的数据量也是巨大的，即便网络带宽状态允许，客户端的计算处理也未必满足要求。

在这种情况下，协处理器（Coprocessors）应运而生。它允许你将业务计算代码放入在RegionServer的协处理器中，将处理好的数据再返回客户端，这可以极大地降低需要传输的数据量，从而获得性能上的提升。同时协处理器也允许用户扩展实现 HBase 目前所不具备的功能，如权限校验、二级索引、完整性约束等。

#### 二、协处理器类型

**2.1 Observer**

1. 功能：

   Observer 协处理器类似于关系型数据库中的触发器，当发生某些事件的时候这类协处理器会被 Server 端调用。通常可以用来实现下面功能：

   - **权限校验**：在执行 `Get` 或 `Put` 操作之前，您可以使用 `preGet` 或 `prePut` 方法检查权限；
   - **完整性约束**： HBase 不支持关系型数据库中的外键功能，可以通过触发器在插入或者删除数据的时候，对关联的数据进行检查；
   - **二级索引**： 可以使用协处理器来维护二级索引。

2. 类型

   当前 Observer 协处理器有以下四种类型：

   - **RegionObserver** : 允许您观察 Region 上的事件，例如 Get 和 Put 操作。
   - **RegionServerObserver** : 允许您观察与 RegionServer 操作相关的事件，例如启动，停止或执行合并，提交或回滚。
   - **MasterObserver** : 允许您观察与 HBase Master 相关的事件，例如表创建，删除或 schema 修改。
   - **WalObserver** : 允许您观察与预写日志（WAL）相关的事件。

   以上四种类型的 Observer 协处理器均继承自 `Coprocessor` 接口，这里以 `RegionObservers `为例，其接口类中定义了所有可用的钩子方法，下面截取了部分方法的定义，多数方法都是成对出现的，有 `pre` 就有 `post`：

**2.2 Endpoint协处理器**

#### 四、协处理器加载方式

4.1 静态加载与卸载（hbase-site.xml配置文件）

4.2 动态加载与卸载

使用动态加载协处理器，不需要重新启动 HBase。动态加载通常有两种方式：Shell 和 Java API 